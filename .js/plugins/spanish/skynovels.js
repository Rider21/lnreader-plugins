var e=this&&this.__awaiter||function(e,n,t,o){return new(t||(t=Promise))((function(r,i){function l(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,s)}a((o=o.apply(e,n||[])).next())}))},n=this&&this.__generator||function(e,n){var t,o,r,i,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(a){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(l=0)),l;)try{if(t=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return l.label++,{value:s[1],done:!1};case 5:l.label++,o=s[1],s=[0];continue;case 7:s=l.ops.pop(),l.trys.pop();continue;default:if(!(r=l.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){l=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){l.label=s[1];break}if(6===s[0]&&l.label<r[1]){l.label=r[1],r=s;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(s);break}r[2]&&l.ops.pop(),l.trys.pop();continue}s=n.call(e,l)}catch(e){s=[6,e],o=0}finally{t=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(exports,"__esModule",{value:!0});var t=require("@libs/fetch"),o=function(){function o(){this.id="skynovels",this.name="SkyNovels",this.site="https://www.skynovels.net/",this.version="1.0.0",this.icon="src/es/skynovels/icon.png"}return o.prototype.popularNovels=function(o,r){var i;return e(this,void 0,void 0,(function(){var e,o;return n(this,(function(n){switch(n.label){case 0:return[4,(0,t.fetchApi)("https://api.skynovels.net/api/novels?&q")];case 1:return[4,n.sent().json()];case 2:return e=n.sent(),o=[],null===(i=e.novels)||void 0===i||i.forEach((function(e){var n=e.nvl_title,t="https://api.skynovels.net/api/get-image/"+e.image+"/novels/false",r={name:n,path:"novelas/"+e.id+"/"+e.nvl_name+"/",cover:t};o.push(r)})),[2,o]}}))}))},o.prototype.parseNovel=function(o){var r,i,l;return e(this,void 0,void 0,(function(){var e,s,a,u,c,v,p;return n(this,(function(n){switch(n.label){case 0:return e=o.split("/")[1],s="https://api.skynovels.net/api/novel/"+e+"/reading?&q",[4,(0,t.fetchApi)(s)];case 1:return[4,n.sent().json()];case 2:return a=n.sent(),u=null===(r=null==a?void 0:a.novel)||void 0===r?void 0:r[0],(c={path:o,name:(null==u?void 0:u.nvl_title)||"Untitled"}).cover="https://api.skynovels.net/api/get-image/"+(null==u?void 0:u.image)+"/novels/false",v=[],null===(i=null==u?void 0:u.genres)||void 0===i||i.forEach((function(e){return v.push(e.genre_name)})),c.genres=v.join(","),c.author=null==u?void 0:u.nvl_writer,c.summary=null==u?void 0:u.nvl_content,c.status=null==u?void 0:u.nvl_status,p=[],null===(l=null==u?void 0:u.volumes)||void 0===l||l.forEach((function(e){var n;null===(n=null==e?void 0:e.chapters)||void 0===n||n.forEach((function(e){var n={name:e.chp_index_title,releaseTime:new Date(e.createdAt).toDateString(),path:o+e.id+"/"+e.chp_name};p.push(n)}))})),c.chapters=p,[2,c]}}))}))},o.prototype.parseChapter=function(o){var r;return e(this,void 0,void 0,(function(){var e,i,l,s;return n(this,(function(n){switch(n.label){case 0:return e=o.split("/")[3],i="https://api.skynovels.net/api/novel-chapter/".concat(e),[4,(0,t.fetchApi)(i)];case 1:return[4,n.sent().json()];case 2:return l=n.sent(),s=null===(r=null==l?void 0:l.chapter)||void 0===r?void 0:r[0],[2,(null==s?void 0:s.chp_content)||"404"]}}))}))},o.prototype.searchNovels=function(o,r){var i;return e(this,void 0,void 0,(function(){var e,r,l;return n(this,(function(n){switch(n.label){case 0:return o=o.toLowerCase(),[4,(0,t.fetchApi)("https://api.skynovels.net/api/novels?&q")];case 1:return[4,n.sent().json()];case 2:return e=n.sent(),r=null===(i=null==e?void 0:e.novels)||void 0===i?void 0:i.filter((function(e){return e.nvl_title.toLowerCase().includes(o)})),l=[],null==r||r.forEach((function(e){var n=e.nvl_title,t="https://api.skynovels.net/api/get-image/"+e.image+"/novels/false",o={name:n,path:"novelas/"+e.id+"/"+e.nvl_name+"/",cover:t};l.push(o)})),[2,l]}}))}))},o}();exports.default=new o;